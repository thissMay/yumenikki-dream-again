[gd_scene load_steps=19 format=4 uid="uid://b67q2b5hm6tsu"]

[ext_resource type="Script" uid="uid://b1ofr4umso5jf" path="res://src/systems/scenes/game/game_scene.gd" id="1_inoc5"]
[ext_resource type="Shader" uid="uid://dqxrs4a4y611c" path="res://src/shaders/panorama/linear.gdshader" id="2_odm8p"]
[ext_resource type="Texture2D" uid="uid://cpsg4xvrbf3mo" path="res://src/images/panorama/eyeball_panorama.png" id="3_4j00j"]
[ext_resource type="PackedScene" uid="uid://crej0xx7uj05p" path="res://src/levels/__ignore/door.tscn" id="3_07q2v"]
[ext_resource type="PackedScene" uid="uid://djnomncx1otsq" path="res://src/systems/seamless_detector.tscn" id="4_cu3a0"]
[ext_resource type="PackedScene" uid="uid://c8bnpo28a373g" path="res://src/systems/camera/camera.tscn" id="4_sthxv"]
[ext_resource type="Script" uid="uid://b4b3kjcm65mv6" path="res://src/systems/audio/bgm.gd" id="5_cu3a0"]
[ext_resource type="TileSet" uid="uid://ucja6rk8c0dh" path="res://src/levels/__ignore/tilemaps/eyeball.tres" id="5_pagnx"]
[ext_resource type="AudioStream" uid="uid://dexpefjcufc0b" path="res://src/audio/bgm/world_eyeball.ogg" id="6_jutn4"]
[ext_resource type="PackedScene" uid="uid://ryhx8o46er7i" path="res://src/player/madotsuki/madotsuki.tscn" id="9_4j00j"]
[ext_resource type="Script" uid="uid://bxh774473av7t" path="res://src/systems/interaction/base_interactable.gd" id="11_x4bpl"]
[ext_resource type="Script" uid="uid://bkadpjx8csm75" path="res://src/systems/sequence/game/on_interact.gd" id="12_ppt66"]
[ext_resource type="Script" uid="uid://b8vm7vkk5240d" path="res://src/systems/event/player/append_new_effect.gd" id="13_ppt66"]
[ext_resource type="Resource" uid="uid://bi65brqjolfb" path="res://src/player/madotsuki/effects/medamude/medamude.tres" id="14_04s3o"]
[ext_resource type="Script" uid="uid://vk574kc3l7av" path="res://src/systems/event/audio/play_sound.gd" id="15_d5n0m"]
[ext_resource type="AudioStream" uid="uid://berstp18uwqhm" path="res://src/audio/se/effect_found.WAV" id="16_fot1s"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_sthxv"]
shader = ExtResource("2_odm8p")
shader_parameter/transparency = 0.0
shader_parameter/dirX = -1.0
shader_parameter/dirY = 1.0
shader_parameter/scroll_speed = 0.05
shader_parameter/uv_offset_initial = Vector2(0, 0)
shader_parameter/offset_strength = 0.15
shader_parameter/offset_strength_x_influence = 1.0
shader_parameter/offset_strength_y_influence = 1.0
shader_parameter/initial_uv_offset = Vector2(0, 0)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_d5n0m"]
size = Vector2(20, 50)

[node name="eyeball_world" type="Node"]
script = ExtResource("1_inoc5")
metadata/_custom_type_script = "uid://b1ofr4umso5jf"

[node name="BGM" type="Node" parent="."]
script = ExtResource("5_cu3a0")
stream = ExtResource("6_jutn4")
metadata/_custom_type_script = "uid://b4b3kjcm65mv6"

[node name="panorama (bottom_layer)" type="CanvasLayer" parent="."]
layer = -30

[node name="EyeballPanorama" type="TextureRect" parent="panorama (bottom_layer)"]
material = SubResource("ShaderMaterial_sthxv")
offset_right = 480.0
offset_bottom = 300.0
texture = ExtResource("3_4j00j")
stretch_mode = 6

[node name="camera" parent="." instance=ExtResource("4_sthxv")]

[node name="camera_handler" parent="camera" index="0" node_paths=PackedStringArray("target")]
target = NodePath("../../y_order/Madotsuki")

[node name="y_order" type="Node2D" parent="."]
y_sort_enabled = true

[node name="nexus" parent="y_order" instance=ExtResource("3_07q2v")]
position = Vector2(60, 15)

[node name="tilemap" type="TileMapLayer" parent="y_order"]
y_sort_enabled = true
tile_map_data = PackedByteArray("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")
tile_set = ExtResource("5_pagnx")

[node name="seamless_detector" parent="y_order" instance=ExtResource("4_cu3a0")]
position = Vector2(-330, -270)
tile_size = Vector2i(15, 15)
expansion = Vector2i(80, 70)
boundary_size = Vector2i(1680, 1320)
min_bound_size_multiplier = Vector2i(32, 18)
min_boundary_size = Vector2i(480, 270)

[node name="Madotsuki" parent="y_order" instance=ExtResource("9_4j00j")]
position = Vector2(75, 45)

[node name="Interactable" type="Area2D" parent="y_order"]
position = Vector2(1056, 216)
script = ExtResource("11_x4bpl")
size = Vector2i(20, 50)
shape = SubResource("RectangleShape2D_d5n0m")
debug_colour = Color(0.9, 0, 0.7, 0.3)
metadata/_custom_type_script = "uid://bxh774473av7t"

[node name="Sequence" type="Node" parent="y_order/Interactable"]
script = ExtResource("12_ppt66")
metadata/_custom_type_script = "uid://c1od80bn28h0l"

[node name="Event" type="Node" parent="y_order/Interactable/Sequence"]
script = ExtResource("13_ppt66")
effect = ExtResource("14_04s3o")
metadata/_custom_type_script = "uid://0v2nidb8jsha"

[node name="play_sound" type="Node" parent="y_order/Interactable/Sequence"]
script = ExtResource("15_d5n0m")
sound = ExtResource("16_fot1s")
metadata/_custom_type_script = "uid://0v2nidb8jsha"

[editable path="camera"]
