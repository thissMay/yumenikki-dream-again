[gd_scene load_steps=30 format=4 uid="uid://dl7sdjmo0vbkt"]

[ext_resource type="Script" uid="uid://b1ofr4umso5jf" path="res://src/systems/scenes/game/game_scene.gd" id="1_5js63"]
[ext_resource type="PackedScene" uid="uid://c8bnpo28a373g" path="res://src/systems/camera/camera.tscn" id="2_flyuj"]
[ext_resource type="TileSet" uid="uid://crsr3gx0s6ht5" path="res://src/levels/_ignore/tilemaps/apartment.tres" id="3_l77hn"]
[ext_resource type="PackedScene" uid="uid://crej0xx7uj05p" path="res://src/levels/_ignore/door.tscn" id="4_317xn"]
[ext_resource type="PackedScene" uid="uid://ryhx8o46er7i" path="res://src/player/madotsuki/madotsuki.tscn" id="5_j7r18"]
[ext_resource type="Script" uid="uid://bau5lvtg1mbkj" path="res://src/systems/interaction/door_inscene.gd" id="6_yuafm"]
[ext_resource type="Script" uid="uid://bgvtp4rm5gyus" path="res://src/systems/camera/cam_region.gd" id="7_fi45b"]
[ext_resource type="Texture2D" uid="uid://c6glk4dy75gcg" path="res://src/images/panorama/dusk.png" id="8_0oore"]
[ext_resource type="Shader" uid="uid://bqp8m8worpqyn" path="res://src/shaders/panorama/linear_fog.gdshader" id="9_gfwn5"]
[ext_resource type="Texture2D" uid="uid://c8k1sxkde80gi" path="res://src/images/panorama/clouds.png" id="10_bl3wm"]
[ext_resource type="Shader" uid="uid://bjc3g4hpc28r1" path="res://src/shaders/screen_overlay/ocean_lights.gdshader" id="11_ai2lp"]
[ext_resource type="Texture2D" uid="uid://6hbdjnabl7un" path="res://src/images/panorama/hills.png" id="12_ykehj"]
[ext_resource type="Script" uid="uid://b4b3kjcm65mv6" path="res://src/systems/audio/bgm.gd" id="13_w0pgu"]
[ext_resource type="AudioStream" uid="uid://drbxal7equ2eo" path="res://src/audio/bgm/balcony.WAV" id="14_dox4u"]
[ext_resource type="Texture2D" uid="uid://emb20h3qe8rj" path="res://src/levels/balcony/balcony_base.png" id="15_spipe"]
[ext_resource type="Texture2D" uid="uid://bcaws1jajinjy" path="res://src/levels/balcony/coat_hander.png" id="16_yfivs"]
[ext_resource type="Texture2D" uid="uid://chk8hbfa8jypl" path="res://src/levels/balcony/rails.png" id="17_c8oa2"]

[sub_resource type="Gradient" id="Gradient_1hvly"]

[sub_resource type="GradientTexture2D" id="GradientTexture2D_44228"]
gradient = SubResource("Gradient_1hvly")
fill_to = Vector2(0, 1)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_5vp0h"]

[sub_resource type="FastNoiseLite" id="FastNoiseLite_8cbwq"]

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_y6mui"]
seamless = true
noise = SubResource("FastNoiseLite_8cbwq")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_6jswv"]
shader = ExtResource("9_gfwn5")
shader_parameter/transparency = 0.51
shader_parameter/dirX = -1.0
shader_parameter/dirY = 0.0
shader_parameter/scroll_speed = 0.05
shader_parameter/initial_uv_offset = Vector2(0, -0.68)
shader_parameter/offset_strength = 0.0
shader_parameter/offset_strength_x_influence = 1.0
shader_parameter/offset_strength_y_influence = 1.0
shader_parameter/noise = SubResource("NoiseTexture2D_y6mui")
shader_parameter/color_overlay = Color(0.592351, 0.580878, 0.381491, 1)
shader_parameter/color_overlay_intensity = 0.66

[sub_resource type="Gradient" id="Gradient_stpgo"]
offsets = PackedFloat32Array(0, 0.817857, 1)
colors = PackedColorArray(0, 0, 0, 1, 0.33793, 0.279863, 0.152897, 1, 0.950841, 0.744124, 0.439594, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_rho35"]
gradient = SubResource("Gradient_stpgo")
fill_from = Vector2(0, 0.269231)
fill_to = Vector2(0, 1)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_6jswv"]

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_8cbwq"]
noise = SubResource("FastNoiseLite_6jswv")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_y6mui"]
shader = ExtResource("11_ai2lp")
shader_parameter/opacity = 1.0
shader_parameter/noise = SubResource("NoiseTexture2D_8cbwq")
shader_parameter/scroll_speed = 0.015
shader_parameter/offset_strength = 0.05
shader_parameter/uv_offset = Vector2(0, 0)
shader_parameter/gradient = SubResource("GradientTexture2D_rho35")
shader_parameter/ray_strength = 1.225

[sub_resource type="RectangleShape2D" id="RectangleShape2D_3jmax"]
size = Vector2(8, 8)

[node name="room" type="Node2D"]
script = ExtResource("1_5js63")
metadata/_custom_type_script = "uid://b1ofr4umso5jf"

[node name="camera" parent="." instance=ExtResource("2_flyuj")]

[node name="camera_handler" parent="camera" index="0" node_paths=PackedStringArray("target")]
target = NodePath("../../room/Madotsuki")

[node name="room" type="Node2D" parent="."]
position = Vector2(-624, 0)

[node name="ColorRect" type="ColorRect" parent="room"]
z_index = -1
offset_left = -8.0
offset_top = -32.0
offset_right = 504.0
offset_bottom = 272.0
color = Color(0, 0, 0, 1)

[node name="wall" type="TileMapLayer" parent="room"]
position = Vector2(32, -48)
tile_map_data = PackedByteArray("AAAHAAcAAAAEAAUAAAAHAAgAAAAEAAYAAAAJAAYAAAAEAAUAAAAJAAcAAAAEAAYAAAAKAAYAAAAEAAUAAAAKAAcAAAAEAAYAAAALAAYAAAAEAAUAAAALAAcAAAAEAAYAAAAMAAYAAAAEAAUAAAAMAAcAAAAEAAYAAAANAAYAAAAEAAUAAAANAAcAAAAEAAYAAAAOAAYAAAAEAAUAAAAOAAcAAAAEAAYAAAAPAAYAAAAEAAUAAAAPAAcAAAAEAAYAAAAIAAcAAAAEAAUAAAAIAAgAAAAEAAYAAAAQAAYAAAAEAAUAAAAQAAcAAAAEAAYAAAARAAYAAAAEAAUAAAARAAcAAAAEAAYAAAASAAcAAAAEAAUAAAATAAcAAAAEAAUAAAATAAgAAAAEAAYAAAASAAgAAAAEAAYAAAAIAA8AAAACAAYAAAAJAA8AAAACAAYAAAAKAA8AAAACAAYAAAALAA8AAAACAAYAAAAMAA8AAAACAAYAAAANAA8AAAAAAAAAAAAOAA8AAAABAAAAAAAPAA8AAAACAAYAAAAQAA8AAAACAAYAAAARAA8AAAACAAYAAAASAA8AAAACAAYAAAATAA8AAAACAAYAAAAHAA8AAAACAAYAAAAIABAAAAAAAAYAAAAJABAAAAAAAAYAAAAKABAAAAAAAAYAAAALABAAAAAAAAYAAAAMABAAAAAAAAYAAAANABAAAAAAAAEAAAAOABAAAAABAAEAAAAPABAAAAAAAAYAAAAQABAAAAAAAAYAAAARABAAAAAAAAYAAAASABAAAAAAAAYAAAATABAAAAAAAAYAAAAHABAAAAAAAAYAAAAIAAYAAAAAAAYAAAAHAAYAAAAAAAYAAAAGAAYAAAAAAAYAAAAGAAcAAAAAAAYAAAAGAAgAAAAAAAYAAAAGAAkAAAAAAAYAAAAGAAoAAAAAAAYAAAAGAAsAAAAAAAYAAAAGAAwAAAAAAAYAAAAGAA0AAAAAAAYAAAAGAA4AAAAAAAYAAAAGAA8AAAAAAAYAAAAIAAUAAAAAAAYAAAAJAAUAAAAAAAYAAAAKAAUAAAAAAAYAAAALAAUAAAAAAAYAAAAMAAUAAAAAAAYAAAANAAUAAAAAAAYAAAAOAAUAAAAAAAYAAAAPAAUAAAAAAAYAAAAQAAUAAAAAAAYAAAARAAUAAAAAAAYAAAASAAUAAAAAAAYAAAASAAYAAAAAAAYAAAATAAYAAAAAAAYAAAAUAAYAAAAAAAYAAAAUAAcAAAAAAAYAAAAUAAgAAAAAAAYAAAAUAAkAAAAAAAYAAAAUAAoAAAAAAAYAAAAUAAsAAAAAAAYAAAAUAAwAAAAAAAYAAAAUAA0AAAAAAAYAAAAUAA4AAAAAAAYAAAAUAA8AAAAAAAYAAAAUABAAAAAAAAYAAAA=")
tile_set = ExtResource("3_l77hn")

[node name="floor" type="TileMapLayer" parent="room"]
z_index = -1
position = Vector2(32, -48)
tile_map_data = PackedByteArray("AAAIAAkAAAABAAQAAAAIAAoAAAABAAQAAAAJAAsAAAABAAQAAAAKAAwAAAABAAQAAAALAAwAAAABAAQAAAAMAA0AAAABAAQAAAANAA0AAAABAAQAAAAOAA0AAAABAAQAAAAPAA0AAAABAAQAAAAPAAgAAAABAAQAAAAMAAgAAAABAAQAAAALAAgAAAABAAQAAAAKAAkAAAABAAQAAAAJAAkAAAABAAQAAAAJAA4AAAABAAQAAAAKAA4AAAABAAQAAAALAA4AAAABAAQAAAAMAA8AAAABAAQAAAANAA8AAAABAAQAAAAOAA4AAAABAAQAAAAPAAsAAAABAAQAAAAOAAoAAAABAAQAAAANAAoAAAABAAQAAAAMAAsAAAABAAQAAAAMAAwAAAABAAQAAAAKAAoAAAABAAQAAAAJAAoAAAABAAQAAAAJAAwAAAABAAQAAAAJAA0AAAABAAQAAAAMAA4AAAABAAQAAAANAA4AAAABAAQAAAANAAwAAAABAAQAAAALAAsAAAABAAQAAAAKAAsAAAABAAQAAAAKAA0AAAABAAQAAAALAA0AAAABAAQAAAAPAAwAAAABAAQAAAAPAAoAAAABAAQAAAAMAAoAAAABAAQAAAANAAsAAAABAAQAAAAOAAsAAAABAAQAAAAPAAkAAAABAAQAAAAOAAkAAAABAAQAAAALAAoAAAABAAQAAAAJAAgAAAABAAQAAAAKAAgAAAABAAQAAAANAAgAAAABAAQAAAAMAAkAAAABAAQAAAALAAkAAAABAAQAAAAOAAgAAAABAAQAAAAPAA8AAAABAAQAAAAOAA8AAAABAAQAAAAPAA4AAAABAAQAAAANAAkAAAABAAQAAAAHAAkAAAABAAQAAAAHAAoAAAABAAQAAAAHAAsAAAABAAQAAAAHAAwAAAABAAQAAAAHAA0AAAABAAQAAAAHAA4AAAABAAQAAAAHAA8AAAABAAQAAAAIAA8AAAABAAQAAAAIAA4AAAABAAQAAAAIAA0AAAABAAQAAAAIAAsAAAABAAQAAAAIAAwAAAABAAQAAAAJAA8AAAABAAQAAAAKAA8AAAABAAQAAAALAA8AAAABAAQAAAAQAAgAAAABAAQAAAAQAAkAAAABAAQAAAAQAAoAAAABAAQAAAAQAAsAAAABAAQAAAAQAAwAAAABAAQAAAAQAA0AAAABAAQAAAAQAA4AAAABAAQAAAAQAA8AAAABAAQAAAARAAgAAAABAAQAAAARAAkAAAABAAQAAAARAAoAAAABAAQAAAARAAsAAAABAAQAAAARAAwAAAABAAQAAAARAA0AAAABAAQAAAARAA4AAAABAAQAAAARAA8AAAABAAQAAAASAAkAAAABAAQAAAASAAoAAAABAAQAAAASAAsAAAABAAQAAAASAAwAAAABAAQAAAASAA0AAAABAAQAAAASAA4AAAABAAQAAAASAA8AAAABAAQAAAATAAkAAAABAAQAAAATAAoAAAABAAQAAAATAAsAAAABAAQAAAATAAwAAAABAAQAAAATAA0AAAABAAQAAAATAA4AAAABAAQAAAATAA8AAAABAAQAAAAOAAwAAAABAAQAAAA=")
tile_set = ExtResource("3_l77hn")

[node name="floor_misc" type="TileMapLayer" parent="room"]
position = Vector2(32, -48)
tile_map_data = PackedByteArray("AAAIAAkAAAALAAEAAAAJAAwAAAAFAAEAAAAKAAoAAAAFAAAAAAAKAA0AAAAFAAAAAAALAAkAAAAFAAEAAAAPAAkAAAAFAAAAABASAA4AAAAFAAEAABAOAAwAAAAIAAQAAAAQAAoAAAAFAAEAABASAAkAAAALAAMAAAALAAsAAAAFAAMAAAALAAwAAAAFAAQAAAALAA0AAAAFAAUAAAALAA4AAAAFAAYAAAAMAAsAAAAGAAMAAAAMAAwAAAAGAAQAAAAMAA0AAAAGAAUAAAAMAA4AAAAGAAYAAAANAAsAAAAHAAMAAAANAAwAAAAHAAQAAAANAA0AAAAHAAUAAAANAA4AAAAHAAYAAAAOAAsAAAAIAAMAAAAOAA0AAAAIAAUAAAAOAA4AAAAIAAYAAAAPAAsAAAAJAAMAAAAPAAwAAAAJAAQAAAAPAA0AAAAJAAUAAAAPAA4AAAAJAAYAAAAQAAsAAAAKAAMAAAAQAAwAAAAKAAQAAAAQAA0AAAAKAAUAAAAQAA4AAAAKAAYAAAA=")
tile_set = ExtResource("3_l77hn")

[node name="wall_edges" type="TileMapLayer" parent="room"]
position = Vector2(32, -48)
tile_map_data = PackedByteArray("AAAHAAcAAAAAAAMAAAAHAAgAAAAAAAQAAAAHAAkAAAAAAAQAAAAHAAoAAAAAAAQAAAAHAAsAAAAAAAQAAAAHAAwAAAAAAAQAAAAHAA0AAAAAAAQAAAAIAAYAAAAAAAIAABAIAAcAAAAAAAUAADAJAAYAAAABAAIAACAKAAYAAAABAAIAACALAAYAAAABAAIAACAMAAYAAAABAAIAACANAAYAAAABAAIAACAOAAYAAAABAAIAACAPAAYAAAABAAIAACAQAAYAAAABAAIAACARAAYAAAABAAIAACASAAYAAAAAAAIAAAATAAcAAAAAAAMAABASAAcAAAAAAAUAACATAAgAAAAAAAQAABATAAkAAAAAAAQAABATAAoAAAAAAAQAABATAAsAAAAAAAQAABATAAwAAAAAAAQAABATAA0AAAAAAAQAABAHAA4AAAAAAAQAAAATAA4AAAAAAAQAABA=")
tile_set = ExtResource("3_l77hn")

[node name="door_interactable" parent="room" instance=ExtResource("4_317xn")]
position = Vector2(192, 67)

[node name="Madotsuki" parent="room" instance=ExtResource("5_j7r18")]
position = Vector2(240, 144)

[node name="sun_light" type="PointLight2D" parent="room"]
position = Vector2(256, 160)
scale = Vector2(0.5, 2)
texture = SubResource("GradientTexture2D_44228")

[node name="room_to_balc" type="Area2D" parent="room" node_paths=PackedStringArray("target_door")]
position = Vector2(256, 208)
script = ExtResource("6_yuafm")
spawn_point = Vector2(0, -30)
spawn_dir = Vector2(0, -1)
target_door = NodePath("../../balcony_dream/balcony/balc_to_room")
metadata/_custom_type_script = "uid://bau5lvtg1mbkj"

[node name="CollisionShape2D" type="CollisionShape2D" parent="room/room_to_balc"]
shape = SubResource("RectangleShape2D_5vp0h")

[node name="room_cam_region" type="Area2D" parent="room"]
process_mode = 3
position = Vector2(248, 120)
script = ExtResource("7_fi45b")
instant_cam_switch = true
size = Vector2i(265, 230)
metadata/_custom_type_script = "uid://bgvtp4rm5gyus"

[node name="balcony_dream" type="Node" parent="."]

[node name="panorama (top_layer)" type="CanvasLayer" parent="balcony_dream"]
layer = -20

[node name="Dusk" type="Sprite2D" parent="balcony_dream/panorama (top_layer)"]
use_parent_material = true
position = Vector2(240, 128)
texture = ExtResource("8_0oore")

[node name="Clouds" type="Sprite2D" parent="balcony_dream/panorama (top_layer)"]
material = SubResource("ShaderMaterial_6jswv")
use_parent_material = true
position = Vector2(240, 136)
texture = ExtResource("10_bl3wm")

[node name="ColorRect" type="ColorRect" parent="balcony_dream/panorama (top_layer)"]
material = SubResource("ShaderMaterial_y6mui")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Parallax2D" type="Parallax2D" parent="balcony_dream/panorama (top_layer)"]
scroll_scale = Vector2(0.51, -1.5)
scroll_offset = Vector2(240, 224)

[node name="Hills" type="Sprite2D" parent="balcony_dream/panorama (top_layer)/Parallax2D"]
texture = ExtResource("12_ykehj")

[node name="BGM" type="Node" parent="balcony_dream"]
script = ExtResource("13_w0pgu")
stream = ExtResource("14_dox4u")
metadata/_custom_type_script = "uid://b4b3kjcm65mv6"

[node name="balcony" type="Node2D" parent="balcony_dream"]
y_sort_enabled = true
position = Vector2(0, 32)

[node name="_" type="CanvasGroup" parent="balcony_dream/balcony"]
y_sort_enabled = true

[node name="balcony" type="Sprite2D" parent="balcony_dream/balcony/_"]
z_index = -1
position = Vector2(248, 128)
texture = ExtResource("15_spipe")

[node name="coat_hanger" type="Sprite2D" parent="balcony_dream/balcony/_"]
position = Vector2(280, 152)
texture = ExtResource("16_yfivs")

[node name="rails" type="Sprite2D" parent="balcony_dream/balcony/_"]
position = Vector2(248, 180)
texture = ExtResource("17_c8oa2")

[node name="coll" type="StaticBody2D" parent="balcony_dream/balcony/_"]

[node name="_1" type="CollisionPolygon2D" parent="balcony_dream/balcony/_/coll"]
build_mode = 1
polygon = PackedVector2Array(160, 112, 160, 192, 336, 192, 336, 112)

[node name="_hanger_1" type="CollisionShape2D" parent="balcony_dream/balcony/_/coll"]
position = Vector2(256, 168)
shape = SubResource("RectangleShape2D_3jmax")

[node name="_hanger_2" type="CollisionShape2D" parent="balcony_dream/balcony/_/coll"]
position = Vector2(304, 168)
shape = SubResource("RectangleShape2D_3jmax")

[node name="overlay_modulate" type="CanvasModulate" parent="balcony_dream/balcony"]
color = Color(0.524543, 0.418031, 0.402895, 1)

[node name="balc_to_room" type="Area2D" parent="balcony_dream/balcony" node_paths=PackedStringArray("target_door")]
position = Vector2(256, 120)
script = ExtResource("6_yuafm")
spawn_point = Vector2(0, 5.94)
target_door = NodePath("../../../room/room_to_balc")
metadata/_custom_type_script = "uid://bau5lvtg1mbkj"

[node name="CollisionShape2D" type="CollisionShape2D" parent="balcony_dream/balcony/balc_to_room"]
shape = SubResource("RectangleShape2D_5vp0h")

[node name="cam_region" type="Area2D" parent="balcony_dream/balcony"]
process_mode = 3
position = Vector2(248, 128)
script = ExtResource("7_fi45b")
instant_cam_switch = true
size = Vector2i(200, 120)
metadata/_custom_type_script = "uid://bgvtp4rm5gyus"

[editable path="camera"]
