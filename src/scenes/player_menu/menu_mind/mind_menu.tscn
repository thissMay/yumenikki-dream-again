[gd_scene load_steps=9 format=3 uid="uid://c31720ox0rva"]

[ext_resource type="Shader" uid="uid://dm0qed8urnrei" path="res://src/shaders/masks/bw_invert.gdshader" id="1_ntsdk"]
[ext_resource type="Texture2D" uid="uid://eqrw01saghxu" path="res://src/scenes/player_menu/menu_mind/sally.png" id="2_73hye"]
[ext_resource type="Texture2D" uid="uid://kwmlo4ul1gug" path="res://src/scenes/player_menu/menu_mind/eye.png" id="3_5o8ee"]
[ext_resource type="Script" uid="uid://ctbtfitoggtku" path="res://src/systems/components/component_receiver.gd" id="4_rpqi0"]
[ext_resource type="Theme" uid="uid://bv8atq67jgwrc" path="res://src/global_theme.tres" id="5_73hye"]

[sub_resource type="GDScript" id="GDScript_8r1ct"]
resource_name = "mind_menu"
script/source = "extends Node

@export var stats_label: Label
var stats_changed: EventListener

func _ready() -> void:
	stats_changed = EventListener.new([\"PLAYER_EFFECT_EQUIP\"], false, self)
	stats_changed.listen_to_event(\"PLAYER_EFFECT_DEEQUIP\")
	stats_changed.do_on_notify(func(): stats_label.text = PLInstance.stats_tostring())
	
	stats_label.text = PLInstance.stats_tostring()
	
"

[sub_resource type="ShaderMaterial" id="ShaderMaterial_g06l6"]
shader = ExtResource("1_ntsdk")
shader_parameter/invert = true
shader_parameter/contrast = 1.0

[sub_resource type="GDScript" id="GDScript_24uvm"]
resource_name = "look_at_mouse"
script/source = "extends LookAt


var relative_mouse_pos: Vector2

func _physics_update(_delta: float) -> void:
	if receiver != null:
		relative_mouse_pos = Vector2(
			+Global.get_mouse_position_within_vp() - origin_pos)
			
		receiver.affector.position = receiver.affector.position.lerp(
			r * relative_mouse_pos.normalized() + origin_pos, _delta * 5)
"

[node name="mind_menu" type="Node2D" node_paths=PackedStringArray("stats_label")]
script = SubResource("GDScript_8r1ct")
stats_label = NodePath("Label")

[node name="sally" type="Sprite2D" parent="."]
material = SubResource("ShaderMaterial_g06l6")
position = Vector2(-112, -16)
texture = ExtResource("2_73hye")
centered = false

[node name="Eye" type="Sprite2D" parent="sally"]
use_parent_material = true
position = Vector2(179, 133)
texture = ExtResource("3_5o8ee")
centered = false

[node name="ComponentReceiver" type="Node" parent="sally/Eye" node_paths=PackedStringArray("affector")]
script = ExtResource("4_rpqi0")
affector = NodePath("..")
metadata/_custom_type_script = "uid://ctbtfitoggtku"

[node name="LookAt" type="Node" parent="sally/Eye/ComponentReceiver"]
script = SubResource("GDScript_24uvm")
r = 3.0
metadata/_custom_type_script = "uid://cx4t46m5wt82v"

[node name="Label" type="Label" parent="."]
offset_left = 192.0
offset_top = 80.0
offset_right = 232.0
offset_bottom = 103.0
theme = ExtResource("5_73hye")
text = "Tjese "
